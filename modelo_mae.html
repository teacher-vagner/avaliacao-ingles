<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Avaliação – Língua Inglesa</title>
<script src="config.js"></script>

<style>
body{
  font-family:Arial, sans-serif;
  max-width:900px;
  margin:auto;
  background:#f4f6fb;
  padding:20px;
}
h1,h2,h3{color:#1f4fd8}
.box{
  background:#fff;
  border-radius:8px;
  padding:15px;
  margin-bottom:20px;
}
.linha{
  display:flex;
  gap:10px;
}
.linha input, .linha select{padding:6px}
.nome{width:70%}
.numero{width:10%}
.turma{width:20%}
textarea{width:100%;height:70px}
button{
  padding:12px 18px;
  font-size:16px;
  border:none;
  border-radius:6px;
  background:#1f4fd8;
  color:#fff;
  cursor:pointer;
}
</style>
</head>

<body>

<img src="midia/imagens/teacher.jpg" width="100%">

<h1>Avaliação de Língua Inglesa</h1>

<div class="box">
  <label>Escola</label><br>
  <input id="escola" readonly style="width:100%"><br><br>

  <div class="linha">
    <input id="nome" class="nome" placeholder="Nome do aluno">
    <input id="numero" class="numero" type="number" placeholder="Nº">
    <select id="turma" class="turma">
      <option value="">Turma</option>
      <option>A</option><option>B</option><option>C</option>
      <option>D</option><option>E</option><option>F</option>
    </select>
  </div>
</div>

<form id="quiz" class="box"></form>

<button onclick="finalizar()">Enviar e ver resultado</button>

<div id="resultado" class="box"></div>

<script>
document.getElementById("escola").value = CONFIG.escola;

/************** QUESTÕES **************/
const questoes = [

  {
    tipo:'aberta',
    habilidade:'Writing',
    q: `
      <p>Who is your best friend's name?</p>
      <img src="midia/imagens/imagem1.jpg" width="500">
    `,
    r:['julia']
  },

  {
    tipo:'aberta',
    habilidade:'Writing',
    q:'<p>What is Julia like?</p>',
    r:['smart','funny']
  },

  {
    habilidade:'Listening',
    q: `
      <p>Listen and choose:</p>
      <audio controls style="width:100%">
        <source src="midia/audios/audio1.mp3" type="audio/mpeg">
      </audio>
    `,
    a:['No, you did not.','No, we did not.','No, we did.','No, they did not.'],
    c:1
  },

  {habilidade:'Reading', q:'<p>She ___ my friend.</p>', a:['am','is','are','be'], c:1},
  {habilidade:'Reading', q:'<p>They ___ students.</p>', a:['am','is','are','be'], c:2},
  {habilidade:'Reading', q:'<p>He ___ 12 years old.</p>', a:['am','is','are','be'], c:1},
  {habilidade:'Reading', q:'<p>I ___ a student.</p>', a:['am','is','are','be'], c:0}
];

/************** MONTAGEM **************/
const form = document.getElementById('quiz');

questoes.forEach((q,i)=>{
  let html = `<h3>${i+1}. (${q.habilidade})</h3>` + q.q;

  if(q.a){
    q.a.forEach((alt,j)=>{
      html += `<label><input type="radio" name="q${i}" value="${j}"> ${alt}</label><br>`;
    });
  } else {
    html += `<textarea id="q${i}"></textarea>`;
  }

  form.innerHTML += html;
});

/************** CORREÇÃO **************/
function finalizar(){
  let pontos = 0;
  let respostasTexto = "";

  questoes.forEach((q,i)=>{
    if(q.a){
      const r = document.querySelector(`input[name="q${i}"]:checked`);
      if(r && Number(r.value) === q.c){
        pontos++;
        respostasTexto += `${i+1}. ✔ ${q.a[r.value]}\n`;
      } else {
        respostasTexto += `${i+1}. ✘ ${r ? q.a[r.value] : 'Não respondeu'} | Correta: ${q.a[q.c]}\n`;
      }
    } else {
      const txt = document.getElementById(`q${i}`).value.toLowerCase();
      if(q.r.some(p => txt.includes(p))) pontos++;
      respostasTexto += `${i+1}. ${txt}\n`;
    }
  });

  const nota = Math.round((pontos / questoes.length) * 10);

  document.getElementById("resultado").innerHTML =
    `Aluno: ${nome.value}<br>Nota: ${nota}/10`;

  window.location.href =
    `mailto:${CONFIG.emailProfessor}?subject=Avaliação de Inglês&body=${encodeURIComponent(respostasTexto)}`;
}
</script>

</body>
</html>
